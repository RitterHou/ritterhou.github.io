<!DOCTYPE html><html lang="zh-Hans"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><title>Unicodeä¸UTF-8 - ä¾¯é”çš„æ€è€ƒä¸åˆ†äº«</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><meta name="keywords" content="ç¼–ç ,ç¼–ç¨‹è¯­è¨€"><meta name="description" content="&lt;h3 id=&#34;è®¡ç®—æœºç¼–ç å‘å±•çš„å†å²&#34;&gt;&lt;a href=&#34;#è®¡ç®—æœºç¼–ç å‘å±•çš„å†å²&#34; class=&#34;headerlink&#34; title=&#34;è®¡ç®—æœºç¼–ç å‘å±•çš„å†å²&#34;&gt;&lt;/a&gt;è®¡ç®—æœºç¼–ç å‘å±•çš„å†å²&lt;/h3&gt;&lt;p&gt;å…³äºè®¡ç®—æœºç³»ç»Ÿä¸­ç¼–ç çš„å†å²ï¼ˆä¾‹å¦‚ASCIIã€GBKè¿™äº›ç¼–ç ç­‰ç­‰ï¼‰å°±ä¸ä»‹ç»äº†ï¼Œå¦‚æœæ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹çŸ¥ä¹ä¸Šé¢çš„&lt;a href=&#34;https://www.zhihu.com/question/23374078/answer/69732605&#34;&gt;è¿™ä¸ªå›ç­”&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;Unicodeå­—ç¬¦é›†&#34;&gt;&lt;a href=&#34;#Unicodeå­—ç¬¦é›†&#34; class=&#34;headerlink&#34; title=&#34;Unicodeå­—ç¬¦é›†&#34;&gt;&lt;/a&gt;Unicodeå­—ç¬¦é›†&lt;/h3&gt;&lt;p&gt;Unicode(Universal Multiple-Octet Coded Character Set)æ˜¯ç”±ISOæå‡ºçš„ï¼Œè¿™æ˜¯ä¸€ç§æ—¨åœ¨åŒ…å«ç›®å‰ä¸–ç•Œä¸Šæ‰€æœ‰æ–‡åŒ–ã€æ‰€æœ‰å­—æ¯çš„å­—ç¬¦ç¼–ç è¡¨ï¼Œå…¶ç›®çš„æ˜¯ä¸–ç•Œä¸Šä»»æ„ä¸€ä¸ªå­—ç¬¦éƒ½å¯ä»¥åœ¨è¯¥è¡¨ä¸­æ‰¾åˆ°å…¶æ‰€å¯¹åº”çš„ç¼–ç å€¼ã€‚Unicodeå­—ç¬¦é›†å…¼å®¹ASCIIç ä¸­çš„ 0 ~ 127 ä½å­—ç¬¦ï¼Œå¯¹äºè¿™äº›å­—ç¬¦Uni"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ä¾¯é”çš„æ€è€ƒä¸åˆ†äº«" type="application/atom+xml"></head><body><div class="container"><header class="header"><div class="blog-title"><a href="/" class="logo">ä¾¯é”çš„æ€è€ƒä¸åˆ†äº«</a><div class="subtitle"></div></div><nav class="navbar"><ul class="menu"><li class="menu-item"><a href="/" class="menu-item-link" data-no-instant>ä¸»é¡µ</a></li><li class="menu-item"><a href="/atom.xml" class="menu-item-link" data-no-instant>è®¢é˜…</a></li><li class="menu-item"><a href="/search" class="menu-item-link" data-no-instant>æœç´¢</a></li></ul></nav></header><article class="post"><div class="post-title"><h1 class="article-title">Unicodeä¸UTF-8</h1></div><div class="post-meta"><span class="post-time">2019-04-27</span></div><div class="post-content"><h3 id="è®¡ç®—æœºç¼–ç å‘å±•çš„å†å²"><a href="#è®¡ç®—æœºç¼–ç å‘å±•çš„å†å²" class="headerlink" title="è®¡ç®—æœºç¼–ç å‘å±•çš„å†å²"></a>è®¡ç®—æœºç¼–ç å‘å±•çš„å†å²</h3><p>å…³äºè®¡ç®—æœºç³»ç»Ÿä¸­ç¼–ç çš„å†å²ï¼ˆä¾‹å¦‚ASCIIã€GBKè¿™äº›ç¼–ç ç­‰ç­‰ï¼‰å°±ä¸ä»‹ç»äº†ï¼Œå¦‚æœæ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹çŸ¥ä¹ä¸Šé¢çš„<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/23374078/answer/69732605">è¿™ä¸ªå›ç­”</a>ã€‚</p><h3 id="Unicodeå­—ç¬¦é›†"><a href="#Unicodeå­—ç¬¦é›†" class="headerlink" title="Unicodeå­—ç¬¦é›†"></a>Unicodeå­—ç¬¦é›†</h3><p>Unicode(Universal Multiple-Octet Coded Character Set)æ˜¯ç”±ISOæå‡ºçš„ï¼Œè¿™æ˜¯ä¸€ç§æ—¨åœ¨åŒ…å«ç›®å‰ä¸–ç•Œä¸Šæ‰€æœ‰æ–‡åŒ–ã€æ‰€æœ‰å­—æ¯çš„å­—ç¬¦ç¼–ç è¡¨ï¼Œå…¶ç›®çš„æ˜¯ä¸–ç•Œä¸Šä»»æ„ä¸€ä¸ªå­—ç¬¦éƒ½å¯ä»¥åœ¨è¯¥è¡¨ä¸­æ‰¾åˆ°å…¶æ‰€å¯¹åº”çš„ç¼–ç å€¼ã€‚Unicodeå­—ç¬¦é›†å…¼å®¹ASCIIç ä¸­çš„ 0 ~ 127 ä½å­—ç¬¦ï¼Œå¯¹äºè¿™äº›å­—ç¬¦Unicodeä¼šå°†å…¶ASCIIç å€¼æ”¾åœ¨ä½ä½ï¼Œé«˜ä½å…¨éƒ¨ç½®ä¸ºé›¶ã€‚</p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Unicode%E5%AD%97%E7%AC%A6%E5%B9%B3%E9%9D%A2%E6%98%A0%E5%B0%84">Unicodeå­—ç¬¦å¹³é¢æ˜ å°„</a>æŠŠUnicodeåˆ†ä¸º17ä¸ªå¹³é¢ï¼ˆPlaneï¼‰ï¼Œæ¯ä¸ªå¹³é¢æ‹¥æœ‰ <code>2 ^ 16 = 65536</code> ä¸ªä»£ç ç‚¹ï¼Œå³æ¯ä¸ªå¹³é¢å¯ä»¥è¡¨ç¤º65536ä¸ªå­—ç¬¦ã€‚è¿™17ä¸ªå¹³é¢çš„èŒƒå›´å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>å¹³é¢</th><th>ç¼–ç å–å€¼èŒƒå›´</th></tr></thead><tbody><tr><td>0å·å¹³é¢</td><td>U+0000 - U+FFFF</td></tr><tr><td>1å·å¹³é¢</td><td>U+10000 - U+1FFFF</td></tr><tr><td>2å·å¹³é¢</td><td>U+20000 - U+2FFFF</td></tr><tr><td>3å·å¹³é¢</td><td>U+30000 - U+3FFFF</td></tr><tr><td>4å·å¹³é¢ - 13å·å¹³é¢</td><td>U+40000 - U+DFFFF</td></tr><tr><td>14å·å¹³é¢</td><td>U+E0000 - U+EFFFF</td></tr><tr><td>15å·å¹³é¢</td><td>U+F0000 - U+FFFFF</td></tr><tr><td>16å·å¹³é¢</td><td>U+100000 - U+10FFFF</td></tr></tbody></table><p>ä½œä¸ºä½¿ç”¨è€…ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦äº†è§£Unicodeæ˜¯å¦‚ä½•è®¾è®¡å¹¶å¯¹å­—ç¬¦è¿›è¡Œåˆ†ç±»çš„ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“åœ¨Unicodeä¸­<strong>ä¸€ä¸ªå­—ç¬¦å¯¹åº”äº†ä¸€ä¸ªå”¯ä¸€çš„ç¼–ç </strong>å°±å¯ä»¥äº†ï¼Œè¿™ä¸ªå”¯ä¸€ç¼–ç å«åš<code>code point</code>ï¼Œå…¶å®å°±æ˜¯è¯¥å­—ç¬¦åœ¨ç¼–ç è¡¨ä¸­çš„ä½ç½®ä¸‹æ ‡ã€‚</p><h3 id="utf-8ç¼–ç "><a href="#utf-8ç¼–ç " class="headerlink" title="utf-8ç¼–ç "></a>utf-8ç¼–ç </h3><p>utf-8æ˜¯Unicodeçš„ä¸€ç§å˜é•¿åº¦çš„ç¼–ç è¡¨è¾¾æ–¹å¼ï¼ŒUnicodeå­—ç¬¦é›†ä¸­æœ‰ç›¸å½“å¤šçš„å­—ç¬¦å…¶ç¼–ç é«˜ä½éƒ½æ˜¯é›¶ï¼Œè¿™æµªè´¹äº†å¾ˆå¤šçš„ç©ºé—´ã€‚ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå¯ä»¥<strong>ä½¿ç”¨utf-8ç¼–ç æ–¹å¼å¯¹Unicodeåšè¿›ä¸€æ­¥çš„ç¼–ç </strong><sup>æ³¨1</sup>ã€‚ç›¸è¾ƒäºUnicodeï¼Œä½¿ç”¨utf-8ç¼–ç å¯ä»¥æ˜¾è‘—çš„å‡å°‘å­—ç¬¦çš„ç©ºé—´å ç”¨ã€‚</p><p>utf-8å¯¹Unicodeç¼–ç å€¼å°äºU+FFFFçš„å­—ç¬¦ç¼–ç æ•ˆç‡è¾ƒé«˜ï¼Œè€Œå¯¹äºé«˜äºU+FFFFçš„å­—ç¬¦å€¼ä½¿ç”¨utf-16ç¼–ç å¯èƒ½æ˜¯ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œå¥½åœ¨æˆ‘ä»¬å¸¸ç”¨çš„å­—ç¬¦å…¶ç¼–ç å€¼åŸºæœ¬ä¸Šéƒ½ä¸ä¼šè¶…è¿‡U+FFFFï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´utf-8ç¼–ç æ–¹å¼å·²ç»è¶³å¤Ÿæ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ä¸è¿‡äº‹å®ä¸Šï¼Œå‡è®¾ä¸ä½¿ç”¨utf-8æˆ–è€…utf-16ç­‰ç¼–ç æ–¹å¼ï¼Œè€Œæ˜¯<strong>ç›´æ¥ä½¿ç”¨Unicodeç¼–ç åŠ ä¸Šä½¿ç”¨æ•°æ®å‹ç¼©ç®—æ³•ï¼ˆä¾‹å¦‚<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/DEFLATE">DEFLATE</a>ï¼‰</strong>çš„æ–¹å¼ï¼Œä¹Ÿèƒ½å¾—åˆ°è¾ƒå¥½çš„ç©ºé—´èŠ‚çœæ•ˆæœã€‚</p><p>æˆ‘ä»¬å·²ç»çŸ¥é“äº†å¼•å…¥utf-8ç¼–ç æœºåˆ¶çš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘ç©ºé—´çš„å ç”¨ï¼Œä¸‹é¢æˆ‘ä»¬å°±è¯¦ç»†äº†è§£ä¸€ä¸‹utf-8çš„ç¼–ç æ–¹å¼ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªutf-8ç¼–ç ä¸Unicodeç¼–ç çš„å…³ç³»è¡¨</p><table><thead><tr><th>ä½æ•°</th><th>UnicodeèŒƒå›´</th><th>å­—èŠ‚æ•°</th><th>å­—èŠ‚1</th><th>å­—èŠ‚2</th><th>å­—èŠ‚3</th><th>å­—èŠ‚4</th></tr></thead><tbody><tr><td>7</td><td>U+0000 - U+007F</td><td>1</td><td>0xxxxxxx</td><td></td><td></td><td></td></tr><tr><td>11</td><td>U+0080 - U+07FF</td><td>2</td><td>110xxxxx</td><td>10xxxxxx</td><td></td><td></td></tr><tr><td>16</td><td>U+0800 - U+FFFF</td><td>3</td><td>1110xxxx</td><td>10xxxxxx</td><td>10xxxxxx</td><td></td></tr><tr><td>21</td><td>U+10000 - U+1FFFFF</td><td>4</td><td>11110xxx</td><td>10xxxxxx</td><td>10xxxxxx</td><td>10xxxxxx</td></tr></tbody></table><p>ä¸Šé¢åªåˆ—ä¸¾äº†utf-8ç¼–ç åœ¨4ä¸ªå­—èŠ‚ä»¥å†…çš„ç¼–ç æ–¹å¼ï¼Œå†å¤šçš„å› ä¸ºå¾ˆå°‘ä½¿ç”¨æ²¡æœ‰åˆ—ä¸¾å‡ºæ¥ã€‚ä¸Šè¡¨ä¸­çš„ <code>x</code> ä»£è¡¨äº†utf-8ç¼–ç ä¸­çš„ç¼–ç å€¼ï¼Œå¯ä»¥æ ¹æ®å­—ç¬¦è®¡ç®—å¾—åˆ°ã€‚</p><p>æ ¹æ®ä¸Šè¡¨æˆ‘ä»¬å¯ä»¥å¾—åˆ°utf-8ç¼–ç å››ç§æƒ…å†µï¼š</p><ol><li>ç¬¬ä¸€ä¸ªbitä¸º0ï¼Œåˆ™è¯´æ˜è¿™ä¸ªå­—ç¬¦åªå ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œå­—ç¬¦çš„å€¼ä¸ºå7ä¸ªbit</li><li>å‰ä¸‰ä¸ªbitä¸º110ï¼Œåˆ™è¯´æ˜è¿™ä¸ªå­—ç¬¦å ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œå­—ç¬¦çš„å€¼ä¸ºç¬¬ä¸€ä¸ªå­—èŠ‚çš„å5ä¸ªbitåŠ ä¸Šç¬¬äºŒä¸ªå­—èŠ‚çš„å6ä¸ªbit</li><li>å‰å››ä¸ªbitä¸º1110ï¼Œè¯¥å­—ç¬¦å ç”¨ä¸‰ä¸ªå­—èŠ‚ï¼Œå­—ç¬¦çš„å€¼ä¸º å­—èŠ‚ä¸€[4:] + å­—èŠ‚äºŒ[2:] + å­—èŠ‚ä¸‰[2:]</li><li>å‰äº”ä¸ªbitä¸º11110ï¼Œè¯¥å­—ç¬¦å ç”¨å››ä¸ªå­—èŠ‚ï¼Œå­—ç¬¦çš„å€¼ä¸º å­—èŠ‚ä¸€[5:] + å­—èŠ‚äºŒ[2:] + å­—èŠ‚ä¸‰[2:] + å­—èŠ‚å››[2:]</li></ol><p>ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªå®é™…çš„utf-8å’Œunicodeç›¸äº’è½¬åŒ–çš„ä¾‹å­ï¼š</p><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†è¾“å…¥çš„utf-8å­—ç¬¦ä¾æ¬¡è½¬åŒ–ä¸ºå…¶unicode</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">utf8ToUnicode</span><span class="params">(words <span class="type">string</span>)</span></span> ([]<span class="type">uint32</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="comment">// å¯¹å­—èŠ‚åšç§»ä½å¤„ç†ã€‚åŸºç¡€å­—èŠ‚ï¼ŒandByteç”¨äºå‰”é™¤æ— ç”¨çš„bitï¼ŒleftMoveBitä»£è¡¨å·¦ç§»ä½æ•°</span></span><br><span class="line">	cal := <span class="function"><span class="keyword">func</span><span class="params">(baseByte <span class="type">byte</span>, andByte <span class="type">byte</span>, leftMoveBit <span class="type">uint32</span>)</span></span> <span class="type">uint32</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="type">uint32</span>(baseByte&amp;andByte) &lt;&lt; leftMoveBit</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	bytes := []<span class="type">byte</span>(words)</span><br><span class="line">	offset := <span class="number">0</span></span><br><span class="line">	length := <span class="built_in">len</span>(bytes)</span><br><span class="line"></span><br><span class="line">	unicodeList := <span class="built_in">make</span>([]<span class="type">uint32</span>, <span class="number">0</span>) <span class="comment">// å­˜å‚¨æœ€ç»ˆçš„unicodeåˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> offset &lt; length &#123;</span><br><span class="line">		<span class="keyword">var</span> codePoint <span class="type">uint32</span>      <span class="comment">// å­—ç¬¦é›†ä¸­çš„å­—ç¬¦ä½ç½®ä¸‹æ ‡ï¼Œå³unicodeç </span></span><br><span class="line">		codeUnit := bytes[offset] <span class="comment">// æœ€å°ç¼–ç å•ä½ï¼Œå³ç¬¬ä¸€ä¸ªbyte</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// ä¸‹é¢è¿™æ®µä»£ç æ¯”è¾ƒæœºæ¢°ï¼Œå‚è€ƒä¸Šé¢çš„ç¼–ç è¡¨å³å¯ç†è§£</span></span><br><span class="line">		<span class="keyword">if</span> codeUnit&gt;&gt;<span class="number">7</span> == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="comment">// ä¸€ä¸ªå­—èŠ‚</span></span><br><span class="line">			codePoint = <span class="type">uint32</span>(codeUnit)</span><br><span class="line">			offset += <span class="number">1</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> codeUnit&gt;&gt;<span class="number">5</span> == <span class="number">0x6</span> &#123;</span><br><span class="line">			<span class="comment">// ä¸¤ä¸ªå­—èŠ‚</span></span><br><span class="line">			codePoint = cal(bytes[offset], <span class="number">0x1f</span>, <span class="number">6</span>) +</span><br><span class="line">				cal(bytes[offset+<span class="number">1</span>], <span class="number">0x3f</span>, <span class="number">0</span>)</span><br><span class="line">			offset += <span class="number">2</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> codeUnit&gt;&gt;<span class="number">4</span> == <span class="number">0xe</span> &#123;</span><br><span class="line">			<span class="comment">// ä¸‰ä¸ªå­—èŠ‚</span></span><br><span class="line">			codePoint = cal(bytes[offset], <span class="number">0xf</span>, <span class="number">12</span>) +</span><br><span class="line">				cal(bytes[offset+<span class="number">1</span>], <span class="number">0x3f</span>, <span class="number">6</span>) +</span><br><span class="line">				cal(bytes[offset+<span class="number">2</span>], <span class="number">0x3f</span>, <span class="number">0</span>)</span><br><span class="line">			offset += <span class="number">3</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> codeUnit&gt;&gt;<span class="number">3</span> == <span class="number">0x1e</span> &#123;</span><br><span class="line">			<span class="comment">// å››ä¸ªå­—èŠ‚</span></span><br><span class="line">			codePoint = cal(bytes[offset], <span class="number">0x7</span>, <span class="number">18</span>) +</span><br><span class="line">				cal(bytes[offset+<span class="number">1</span>], <span class="number">0x3f</span>, <span class="number">12</span>) +</span><br><span class="line">				cal(bytes[offset+<span class="number">2</span>], <span class="number">0x3f</span>, <span class="number">6</span>) +</span><br><span class="line">				cal(bytes[offset+<span class="number">3</span>], <span class="number">0x3f</span>, <span class="number">0</span>)</span><br><span class="line">			offset += <span class="number">4</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">&quot;éæ³•çš„utf-8å­—ç¬¦&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		unicodeList = <span class="built_in">append</span>(unicodeList, codePoint)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> unicodeList, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†è¾“å…¥çš„unicodeè½¬åŒ–ä¸ºå…¶å¯¹åº”çš„utf-8ç¼–ç </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">unicodeToUtf8</span><span class="params">(code <span class="type">uint32</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	bytes := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">0</span>)</span><br><span class="line">	<span class="comment">// åŒæ ·æ˜¯ä¸€æ®µå¾ˆæœºæ¢°çš„ä»£ç ï¼Œå®ç°å‚è€ƒä¸Šé¢çš„ç¼–ç è¡¨</span></span><br><span class="line">	<span class="keyword">if</span> code &lt; <span class="number">0x80</span> &#123;</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code)&amp;<span class="number">0x7f</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> code &lt; <span class="number">0x800</span> &#123;</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code&gt;&gt;<span class="number">6</span>)&amp;<span class="number">0x1f</span>|<span class="number">0xc0</span>)</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code)&amp;<span class="number">0x3f</span>|<span class="number">0x80</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> code &lt; <span class="number">0x10000</span> &#123;</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code&gt;&gt;<span class="number">12</span>)&amp;<span class="number">0xf</span>|<span class="number">0xe0</span>)</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code&gt;&gt;<span class="number">6</span>)&amp;<span class="number">0x3f</span>|<span class="number">0x80</span>)</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code)&amp;<span class="number">0x3f</span>|<span class="number">0x80</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> code &lt; <span class="number">0x20000</span> &#123;</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code&gt;&gt;<span class="number">18</span>)&amp;<span class="number">0x7</span>|<span class="number">0xf0</span>)</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code&gt;&gt;<span class="number">12</span>)&amp;<span class="number">0x3f</span>|<span class="number">0x80</span>)</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code&gt;&gt;<span class="number">6</span>)&amp;<span class="number">0x3f</span>|<span class="number">0x80</span>)</span><br><span class="line">		bytes = <span class="built_in">append</span>(bytes, <span class="type">byte</span>(code)&amp;<span class="number">0x3f</span>|<span class="number">0x80</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, errors.New(fmt.Sprintf(<span class="string">&quot;0x%x can&#x27;t be convert to utf-8&quot;</span>, code))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> bytes, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	testSet := <span class="string">&quot;È å—äº¬ğŸ‘‰ä¸Šæµ·12aAåŒ—äº¬ã®ğ€‰â˜ºÂ©ï£¿ğŸµğŸ˜†ğŸ˜„â…§ğŸ–¤&quot;</span> <span class="comment">// golangé»˜è®¤ä½¿ç”¨utf-8å¯¹æºä»£ç æ–‡ä»¶è¿›è¡Œç¼–ç </span></span><br><span class="line">	unicodeList, _ := utf8ToUnicode(testSet)</span><br><span class="line">	<span class="keyword">for</span> _, unicode := <span class="keyword">range</span> unicodeList &#123;</span><br><span class="line">		result, err := unicodeToUtf8(unicode)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(err)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;0x%x %s\n&quot;</span>, unicode, <span class="type">string</span>(result))</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>utf-8ä½œä¸ºç°åœ¨æœ€å¹¿æ³›ä½¿ç”¨çš„ç¼–ç æ–¹å¼ï¼Œäº†è§£ä¸€ä¸‹å…¶å·¥ä½œåŸç†è¿˜æ˜¯æœ‰å¿…è¦çš„ã€‚utf-8ç¦»ä¸å¼€unicodeï¼Œutf-8ç¼–ç å‡ºç°çš„ç›®çš„æ˜¯ä¸ºå¯¹unicodeçš„ç¼–ç å€¼è¿›è¡Œå‹ç¼©ï¼Œè¿™æ‰æ˜¯utf-8ç¼–ç çš„æœ€æ ¸å¿ƒæ„ä¹‰ã€‚</p><h3 id="æ³¨"><a href="#æ³¨" class="headerlink" title="æ³¨"></a>æ³¨</h3><ol><li>è¿™é‡Œæœ‰ç‚¹ç»•ï¼ŒUnicodeå’Œutf-8éƒ½æ˜¯ç¼–ç æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å¯¹å®ƒä»¬ä½œåŒºåˆ†ï¼š<ul><li>Unicodeæ˜¯ä¸€ç§è¡¨é©±åŠ¨çš„ç¼–ç æ–¹å¼ï¼Œå³ç¼–ç å€¼æ˜¯é€šè¿‡æŸ¥è¡¨çš„æ–¹å¼è·å¾—çš„</li><li>utf-8æ˜¯ä¸€ç§é€šè¿‡è®¡ç®—è€Œç¼–ç çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—æ¥å®ç°ä¸€ä¸ªå­—ç¬¦çš„utf-8ç¼–ç ä¸Unicodeç¼–ç çš„ç›¸äº’è½¬åŒ–</li></ul></li></ol><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a target="_blank" rel="noopener" href="http://cenalulu.github.io/linux/character-encoding/">ååˆ†é’Ÿææ¸…å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç </a><br><a target="_blank" rel="noopener" href="http://zablog.me/2017/09/18/emoji/">Emojiä¸Unicode</a></p></div><div class="post-copyright"><div><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <span title="Unicodeä¸UTF-8">https://www.nosuchfield.com/2019/04/27/Unicode-and-UTF-8/</span></div><div><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« å‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</div></div><style>summary{cursor:pointer;margin-bottom:10px}summary:focus{outline:0}</style><script src="/js/code-enhancer.js"></script><script src="/js/pangu.min.js"></script><script>pangu.spacingPage()</script><script>function backToTop(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script defer src="https://cloud.umami.is/script.js" data-website-id="267e4aaf-8cb5-464d-b16c-89e66283e505"></script><div class="post-footer"><ul class="post-tag-list" itemprop="keywords"><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/%E7%BC%96%E7%A0%81/" rel="tag">ç¼–ç </a></li><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" rel="tag">ç¼–ç¨‹è¯­è¨€</a></li></ul><span onclick="backToTop()" class="top">è¿”å›é¡¶éƒ¨</span></div></article><footer><span>&copy; 2015 - 2025</span> <span class="author">Raymond</span> <span style="float:right"><span class="upyun">æœ¬ç½‘ç«™ç”±<a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"> <img src="/images/others/upyun.png"></a>æä¾›CDNåŠ é€Ÿ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <a class="filing" href="https://beian.miit.gov.cn/" target="_blank">è‹ICPå¤‡15057335å·</a> <a class="github" href="https://github.com/RitterHou" target="_blank">GitHub</a></span></footer></div></body></html>